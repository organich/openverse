import{u as M}from"./CXqaUaDA.js";import{u as R}from"./C6A5PBPG.js";import{u as L}from"./BDR3Ouqq.js";import{v as V}from"./DEfBnNKa.js";import{s as w}from"./4MnmF0OT.js";import{a as P}from"./DCwVccl7.js";import{u as k,a as B}from"./BADMhBhM.js";import{V as C}from"./Cg8BedNo.js";import{d as D,A as s,N as l,C as N,T as p,M as x,D as A,H as F,L as U,P as H,X as I,U as O}from"./D36rSpla.js";const W=D({__name:"VLoadMore",props:{kind:{},searchTerm:{},relatedTo:{},searchType:{},isFetching:{type:Boolean}},emits:["load-more"],setup(f,{emit:h}){const o=f,g=h,r=s(null),v=L(),{t:n}=M({useScope:"global"}),c=k(),a=B(),{$sendCustomEvent:i}=R(),{currentPage:y}=w(c),u=l(()=>{let e=a.strategy==="default"?"search":"collection";const m=a.collectionValue??"null";return{searchType:o.searchType,query:o.searchTerm,resultPage:y.value||1,kind:e,collectionType:m,collectionValue:a.collectionValue??"null"}}),S=l(()=>c.canLoadMore),t=s(!1),b=async()=>{o.isFetching||(t.value=!1,i("LOAD_MORE_RESULTS",u.value),g("load-more"))},E=()=>{i("REACH_RESULT_END",u.value)},T=l(()=>o.isFetching?n("browsePage.loading"):n("browsePage.load")),d=s(null);N(()=>{d.value=document.getElementById("main-page")});const _=P(r,{scrollTarget:d});return p(v,()=>{t.value=!1}),p(_,e=>{if(e){if(t.value)return;E(),t.value=!0}}),(e,m)=>(x(),A("div",{ref_key:"loadMoreSectionRef",ref:r,class:"w-full"},[F(U(C,{class:"label-bold lg:description-bold h-16 w-full lg:h-18",variant:"filled-gray",size:"disabled",disabled:e.isFetching,"data-testid":"load-more",onClick:b},{default:H(()=>[I(O(T.value),1)]),_:1},8,["disabled"]),[[V,S.value]])],512))}});export{W as _};
